<!DOCTYPE html>
<html lang="hi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crushers Cafe | Official</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #c5a059; --dark: #060e0a; --card: #15291f; }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Poppins', sans-serif; }
        body { background: #0b1a13; color: white; overflow-x: hidden; }

        /* Header */
        header { background: var(--dark); padding: 15px; text-align: center; border-bottom: 2px solid var(--gold); position: sticky; top: 0; z-index: 100; }
        header h1 { color: var(--gold); letter-spacing: 2px; }

        /* Layout */
        .main { display: flex; height: calc(100vh - 150px); }
        .sidebar { width: 100px; background: var(--dark); border-right: 1px solid #1a3327; }
        .cat-btn { padding: 20px 5px; color: #aaa; text-align: center; cursor: pointer; border-bottom: 1px solid #1a3327; font-size: 12px; }
        .cat-btn.active { color: var(--gold); background: rgba(197, 160, 89, 0.1); border-left: 3px solid var(--gold); }

        .content { flex: 1; padding: 15px; overflow-y: auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(140px, 1fr)); gap: 15px; }

        /* Cards */
        .card { background: var(--card); padding: 10px; border-radius: 12px; text-align: center; border: 1px solid #1a3327; }
        .card img { width: 100%; height: 90px; object-fit: cover; border-radius: 8px; }
        
        .qty-box { display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 10px; }
        .btn-q { background: var(--gold); border: none; width: 25px; height: 25px; border-radius: 50%; cursor: pointer; font-weight: bold; }

        /* Admin Panel (Hidden by default) */
        #adminSection { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.95); z-index: 1000; padding: 20px; overflow-y: auto; }
        .admin-box { max-width: 400px; margin: auto; background: var(--card); padding: 20px; border-radius: 15px; border: 1px solid var(--gold); }
        input, select { width: 100%; padding: 10px; margin: 10px 0; border-radius: 5px; border: none; }

        /* Loading & Forms */
        .overlay { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.85); z-index: 2000; align-items: center; justify-content: center; flex-direction: column; }
        .loader { border: 4px solid #f3f3f3; border-top: 4px solid var(--gold); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        footer { position: fixed; bottom: 0; width: 100%; height: 60px; background: var(--dark); border-top: 1px solid var(--gold); display: flex; justify-content: space-between; padding: 0 20px; align-items: center; }
    </style>
</head>
<body>

    <header><h1>CRUSHERS CAFE</h1></header>

    <div class="main">
        <aside class="sidebar" id="cats">
            <div class="cat-btn active" onclick="render('all')">All</div>
            <div class="cat-btn" onclick="render('pizza')">Pizza</div>
            <div class="cat-btn" onclick="render('burger')">Burger</div>
        </aside>
        <main class="content"><div class="grid" id="menuGrid"></div></main>
    </div>

    <footer>
        <div id="bill">Total: ₹0</div>
        <button onclick="openCustomerForm()" style="background:var(--gold); border:none; padding:8px 15px; border-radius:5px; font-weight:bold;">ORDER NOW</button>
    </footer>

    <div id="adminSection">
        <div class="admin-box">
            <h2 style="color:var(--gold)">Admin Menu Control</h2>
            <input type="text" id="itemName" placeholder="Item Name">
            <input type="number" id="itemPrice" placeholder="Price">
            <select id="itemCat">
                <option value="pizza">Pizza</option>
                <option value="burger">Burger</option>
            </select>
            <input type="text" id="itemImg" placeholder="Image Link (URL)">
            <button onclick="saveItem()" style="width:100%; background:var(--gold); padding:10px; border:none; font-weight:bold;">Save Item</button>
            <div id="adminList" style="margin-top:20px;"></div>
            <button onclick="closeAdmin()" style="margin-top:10px; background:none; color:white; border:none; cursor:pointer;">[ Close Admin ]</button>
        </div>
    </div>

    <div id="loadingOverlay" class="overlay">
        <div id="loaderUI">
            <div class="loader"></div>
            <p>Processing Order...</p>
        </div>
        <div id="formUI" class="admin-box" style="display:none;">
            <h3>Customer Details</h3>
            <input type="text" id="cName" placeholder="Enter Name">
            <input type="tel" id="cPhone" placeholder="Phone Number">
            <button onclick="finalSubmit()" style="width:100%; background:var(--gold); padding:10px; border:none; font-weight:bold;">Confirm & WhatsApp</button>
        </div>
    </div>

    <script>
        let cart = {}; let total = 0;

        // --- URL TRICK ---
        function checkUrl() {
            const params = new URLSearchParams(window.location.search);
            if(params.get('admin') === 'google') {
                document.getElementById('adminSection').style.display = 'block';
                loadAdminItems();
            }
        }

        function render(cat='all') {
            const grid = document.getElementById('menuGrid');
            const menu = JSON.parse(localStorage.getItem('cafeMenu')) || [];
            grid.innerHTML = "";
            menu.forEach(item => {
                if(cat === 'all' || item.cat === cat) {
                    grid.innerHTML += `<div class="card">
                        <img src="${item.img || 'https://via.placeholder.com/100'}">
                        <h4>${item.name}</h4><p>₹${item.price}</p>
                        <div class="qty-box">
                            <button class="btn-q" onclick="updateQty('${item.name}', -1, ${item.price})">-</button>
                            <span id="q-${item.name.replace(/\s/g, '')}">0</span>
                            <button class="btn-q" onclick="updateQty('${item.name}', 1, ${item.price})">+</button>
                        </div>
                    </div>`;
                }
            });
        }

        function updateQty(name, delta, price) {
            if(!cart[name]) cart[name] = 0;
            if(cart[name] + delta >= 0) {
                cart[name] += delta; total += (delta * price);
                document.getElementById(`q-${name.replace(/\s/g, '')}`).innerText = cart[name];
                document.getElementById('bill').innerText = "Total: ₹" + total;
            }
        }

        // --- Admin Functions ---
        function saveItem() {
            const name = document.getElementById('itemName').value;
            const price = document.getElementById('itemPrice').value;
            const cat = document.getElementById('itemCat').value;
            const img = document.getElementById('itemImg').value;
            if(!name || !price) return;

            let menu = JSON.parse(localStorage.getItem('cafeMenu')) || [];
            menu.push({name, price, cat, img});
            localStorage.setItem('cafeMenu', JSON.stringify(menu));
            loadAdminItems(); render();
        }

        function loadAdminItems() {
            let menu = JSON.parse(localStorage.getItem('cafeMenu')) || [];
            let list = document.getElementById('adminList');
            list.innerHTML = "";
            menu.forEach((item, i) => {
                list.innerHTML += `<div style="display:flex; justify-content:space-between; margin:5px 0;">
                    <span>${item.name}</span>
                    <button onclick="del(${i})" style="color:red; background:none; border:none; cursor:pointer;">Del</button>
                </div>`;
            });
        }

        function del(i) {
            let menu = JSON.parse(localStorage.getItem('cafeMenu'));
            menu.splice(i, 1); localStorage.setItem('cafeMenu', JSON.stringify(menu));
            loadAdminItems(); render();
        }

        // --- Order Functions ---
        function openCustomerForm() {
            if(total === 0) return alert("Items select karein!");
            document.getElementById('loadingOverlay').style.display = 'flex';
            document.getElementById('loaderUI').style.display = 'none';
            document.getElementById('formUI').style.display = 'block';
        }

        function finalSubmit() {
            const name = document.getElementById('cName').value;
            const phone = document.getElementById('cPhone').value;
            if(!name || !phone) return alert("Details bharein");

            document.getElementById('formUI').style.display = 'none';
            document.getElementById('loaderUI').style.display = 'block';

            setTimeout(() => {
                let orderID = "ORD-" + Math.floor(Math.random()*9000+1000);
                let msg = `*CRUSHERS CAFE*%0AOrder ID: ${orderID}%0AClient: ${name}%0AItems:%0A`;
                for(let k in cart) { if(cart[k]>0) msg += `- ${k} x ${cart[k]}%0A`; }
                msg += `%0A*Total: ₹${total}*`;
                window.location.href = `https://wa.me/919876543210?text=${msg}`;
            }, 2000);
        }

        function closeAdmin() { window.location.href = window.location.pathname; }

        window.onload = () => { checkUrl(); render(); };
    </script>
</body>
</html>
