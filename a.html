<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crushers Cafe</title>

<style>
body{
  margin:0;
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#001a14,#00332a);
  color:#f5d58c;
}
header{
  text-align:center;
  padding:18px;
  font-size:24px;
  letter-spacing:2px;
  font-weight:bold;
  border-bottom:2px solid #caa75e;
}
.wrapper{display:flex;min-height:75vh;}
.sidebar{
  width:160px;
  border-right:1px solid #caa75e;
}
.sidebar button{
  width:100%;padding:15px;background:none;border:none;
  color:#e5c17c;text-align:left;cursor:pointer;
  border-bottom:1px solid rgba(255,255,255,0.1);
}
.sidebar button.active{
  background:#caa75e;color:black;font-weight:bold;
}
.menu{
  flex:1;padding:15px;
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(140px,1fr));
  gap:15px;
}
.card{
  background:rgba(255,255,255,0.05);
  padding:15px;border-radius:10px;text-align:center;
  border:1px solid rgba(255,255,255,0.1);
}
.price{margin-top:5px;font-weight:bold;color:#ffd369;}
.add-btn{
  margin-top:8px;padding:6px 12px;
  background:#caa75e;border:none;border-radius:6px;
  cursor:pointer;font-weight:bold;
}
.bottom-bar{
  position:fixed;bottom:0;width:100%;
  background:#001f1a;border-top:2px solid #caa75e;
  display:flex;justify-content:space-between;
  padding:12px 15px;align-items:center;
}
.order-btn{
  background:#caa75e;border:none;padding:10px 20px;
  border-radius:8px;font-weight:bold;cursor:pointer;
}

/* Popup */
.popup{
  position:fixed;top:0;left:0;right:0;bottom:0;
  background:rgba(0,0,0,0.6);
  display:none;justify-content:center;align-items:center;
}
.popup-content{
  background:#002a22;padding:20px;
  border-radius:10px;width:300px;
}
.popup-content input{
  width:100%;padding:8px;margin-top:10px;
  border-radius:5px;border:none;
}
.popup-content button{
  margin-top:10px;width:100%;
  padding:8px;background:#caa75e;
  border:none;border-radius:6px;font-weight:bold;
}

@media(max-width:768px){
  .wrapper{flex-direction:column;}
  .sidebar{width:100%;display:flex;overflow:auto;}
  .sidebar button{text-align:center;font-size:14px;}
}
</style>
</head>
<body>

<header>ðŸ”¥ CRUSHERS CAFE ðŸ”¥</header>

<div class="wrapper">
  <div class="sidebar" id="categoryBar"></div>
  <div class="menu" id="menu"></div>
</div>

<div class="bottom-bar">
  <div><strong id="total">Total: â‚¹0</strong></div>
  <button class="order-btn" onclick="openPopup()">Order Now</button>
</div>

<div class="popup" id="popup">
  <div class="popup-content">
    <h3>Enter Details</h3>
    <input id="custName" placeholder="Your Name">
    <input id="custPhone" placeholder="Phone Number">
    <button onclick="sendOrder()">Confirm Order</button>
  </div>
</div>

<script>
const sheetURL="https://docs.google.com/spreadsheets/d/e/2PACX-1vRbqnHX8ZIy7DTi2Zch413BxwX_7gCJerCPiFSHsgI83UTyOH137c2sMQJcKqelxFaPSvEGiN7oapwk/pub?gid=0&single=true&output=csv";
const WHATSAPP_NUMBER="918078619566"; // change to your number

let menuData={},currentCategory="",cart=[];

function parseCSV(csv){
  let lines=csv.trim().split("\n");
  let result={};
  for(let i=1;i<lines.length;i++){
    let row=lines[i].split(",");
    if(row.length<4) continue;
    let cat=row[0].trim();
    let item=row[2].trim();
    let price=parseFloat(row[3]);
    if(!result[cat]) result[cat]=[];
    result[cat].push({name:item,price});
  }
  return result;
}

fetch(sheetURL)
.then(res=>res.text())
.then(csv=>{
  menuData=parseCSV(csv);
  currentCategory=Object.keys(menuData)[0];
  loadCategories();
  loadMenu();
});

function loadCategories(){
  let html="";
  for(let cat in menuData){
    html+=`<button onclick="showCategory('${cat}')">${cat}</button>`;
  }
  document.getElementById("categoryBar").innerHTML=html;
}

function showCategory(cat){
  currentCategory=cat;
  loadMenu();
}

function loadMenu(){
  let items=menuData[currentCategory]||[];
  let html="";
  items.forEach((item,i)=>{
    html+=`
    <div class="card">
      <h4>${item.name}</h4>
      <div class="price">â‚¹${item.price}</div>
      <button class="add-btn" onclick="addToCart(${i})">Add</button>
    </div>`;
  });
  document.getElementById("menu").innerHTML=html;
}

function addToCart(i){
  let item=menuData[currentCategory][i];
  let existing=cart.find(x=>x.name===item.name);
  if(existing) existing.qty++;
  else cart.push({...item,qty:1});
  updateCart();
}

function updateCart(){
  let total=0;
  cart.forEach(item=>total+=item.price*item.qty);
  document.getElementById("total").innerText="Total: â‚¹"+total;
}

function openPopup(){
  if(cart.length===0){alert("Cart empty!");return;}
  document.getElementById("popup").style.display="flex";
}

function sendOrder(){
  let name=document.getElementById("custName").value;
  let phone=document.getElementById("custPhone").value;
  if(!name||!phone){alert("Fill details");return;}

  let orderText="Order from Crushers Cafe\n";
  let total=0;
  cart.forEach(item=>{
    total+=item.price*item.qty;
    orderText+=`${item.name} x ${item.qty}\n`;
  });
  orderText+=`Total: â‚¹${total}\nName: ${name}\nPhone: ${phone}`;

  window.open(`https://wa.me/${WHATSAPP_NUMBER}?text=${encodeURIComponent(orderText)}`);
  cart=[];
  updateCart();
  document.getElementById("popup").style.display="none";
}
</script>

</body>
</html>
