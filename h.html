<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Royal Cafe</title>

<script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>

<style>
body{
font-family:Arial;
background:#0f0f0f;
color:white;
padding:20px;
}
h1{text-align:center;color:#d4af37;}
.item{
background:#1a1a1a;
padding:12px;
margin:10px 0;
border-radius:8px;
display:flex;
justify-content:space-between;
align-items:center;
}
button{
background:#d4af37;
border:none;
padding:6px 12px;
border-radius:5px;
cursor:pointer;
}
.cart{
margin-top:20px;
background:#1a1a1a;
padding:15px;
border-radius:8px;
}
input,textarea{
width:100%;
margin-top:8px;
padding:8px;
border-radius:5px;
border:none;
}
.error{color:red;font-size:12px;}
.total{color:#d4af37;font-weight:bold;}
</style>
</head>
<body>

<h1>Royal Cafe ☕</h1>

<div id="menu"></div>

<div class="cart">
<h3>Your Cart</h3>
<div id="cartItems"></div>
<p class="total" id="total">Total: ₹0</p>

<h3>Customer Details</h3>
<input id="name" placeholder="Full Name">
<div id="nameError" class="error"></div>

<input id="phone" placeholder="Phone">
<div id="phoneError" class="error"></div>

<textarea id="address" placeholder="Address"></textarea>
<div id="addressError" class="error"></div>

<button onclick="placeOrder()">Place Order</button>
</div>

<script>

emailjs.init("YOUR_PUBLIC_KEY");

const WHATSAPP="918078619566";

let menu=JSON.parse(localStorage.getItem("menu"))||[
{name:"Cappuccino",price:120},
{name:"Latte",price:140},
{name:"Burger",price:100}
];

let cart=[];

function loadMenu(){
let html="";
menu.forEach((item,i)=>{
html+=`
<div class="item">
<span>${item.name} - ₹${item.price}</span>
<button onclick="addToCart(${i})">Add</button>
</div>`;
});
document.getElementById("menu").innerHTML=html;
}

function addToCart(i){
let existing=cart.find(x=>x.name===menu[i].name);
if(existing) existing.qty++;
else cart.push({...menu[i],qty:1});
updateCart();
}

function updateCart(){
let html="";
let total=0;
cart.forEach(item=>{
total+=item.price*item.qty;
html+=`<p>${item.name} x ${item.qty}</p>`;
});
document.getElementById("cartItems").innerHTML=html;
document.getElementById("total").innerText="Total: ₹"+total;
}

function generateOrderId(name){
let initials=name.split(" ").map(n=>n[0]).join("").toUpperCase();
let random=Math.floor(1000+Math.random()*9000);
return initials+"-"+random;
}

function validate(){
let valid=true;
let name=document.getElementById("name").value.trim();
let phone=document.getElementById("phone").value.trim();
let address=document.getElementById("address").value.trim();

nameError.innerHTML="";
phoneError.innerHTML="";
addressError.innerHTML="";

if(name===""){nameError.innerHTML="Required";valid=false;}
if(!/^[0-9]{10}$/.test(phone)){phoneError.innerHTML="10 digit required";valid=false;}
if(address===""){addressError.innerHTML="Required";valid=false;}
if(cart.length===0){alert("Cart empty");valid=false;}

return valid;
}

function placeOrder(){

if(!validate()) return;

let name=document.getElementById("name").value;
let phone=document.getElementById("phone").value;
let address=document.getElementById("address").value;

let orderId=generateOrderId(name);

let total=0;
let orderText="";
cart.forEach(item=>{
total+=item.price*item.qty;
orderText+=`${item.name} x ${item.qty}\n`;
});

// Save Order in localStorage (for Admin)
let orders=JSON.parse(localStorage.getItem("orders"))||[];
orders.push({orderId,name,phone,address,items:orderText,total});
localStorage.setItem("orders",JSON.stringify(orders));

// Email
emailjs.send("YOUR_SERVICE_ID","YOUR_TEMPLATE_ID",{
name,phone,address,order:orderText,total,orderId
});

// WhatsApp (only order)
let message=`Order ID: ${orderId}\n${orderText}Total: ₹${total}`;
window.open(`https://wa.me/${WHATSAPP}?text=${encodeURIComponent(message)}`);

alert("Order Placed! ID: "+orderId);

cart=[];
updateCart();
}

loadMenu();

</script>
</body>
</html>
